const REGEX_DEFAULT="item>\\s*<title>(?<name>.+?)</title>[\\s\\S]*?<link>(?:<!\\[CDATA\\[)?(?<link>.+?)(?:\\]\\]>)?<[\\s\\S]+?pubDate>(?<date>.+?)<";var quickLinksURLs=[];function readFile(e,t,n){var a=new XMLHttpRequest;a.overrideMimeType(t),a.open("GET",e,!0),a.onload=function(){4===a.readyState&&"200"==a.status&&n(a)},a.send(null)}function loadFeeds(e,t,n,a){var r=document.createElement.bind(document),[o,d,s]=t,l=function(t){var i=t.responseText;d||(d=REGEX_DEFAULT);for(var o,l=new RegExp(d,"g"),c=i.matchAll(l),m=r("ul"),u=!1;!(o=c.next()).done;){matchGroup=o.value.groups;var p=m.appendChild(r("li")).appendChild(r("a"));p.href=s+matchGroup.link,p.appendChild(document.createTextNode(matchGroup.name)),(!a||new Date(matchGroup.date)>a)&&(p.style.color="cyan",u=!0)}u&&(feeds_summary=document.getElementById("feeds-summary"),feeds_summary.appendChild(document.createTextNode(e+", ")),n.appendChild(m))};if(Array.isArray(o))for(i=0;i<o.length;i++)readFile(o[i],"text/xml",l);else readFile(o,"text/xml",l)}function fetchFavicon(e,t=!1){return t&&(e=e.slice(0,e.slice(8).indexOf("/")+9)),"https://www.google.com/s2/favicons?domain="+e}function appendToQuickLinks(e){for(var t=document.getElementById("quick-links"),n=0;n<e.length;n++){var a=document.createElement("div");a.className="bookmark";var i=a.appendChild(document.createElement("a"));i.href=e[n].url;var r=new Image;r.src=e[n].favIconUrl,i.insertAdjacentElement("afterbegin",r),t.appendChild(a),quickLinksURLs.push(e[n].url)}}function appendListToSidebar(e,t=!0){var n=document.createElement.bind(document),a=document.getElementById("sidebar"),i=n("ul");nQuickLinks=quickLinksURLs.length;for(var r=0;r<e.length;r++){var o=e[r].hasOwnProperty("tab")?e[r].tab:e[r];if(o.hasOwnProperty("url")&&!o.url.startsWith("edge://")){for(var d=o.url.includes.bind(o.url),s=0;s<nQuickLinks;s++)d(quickLinksURLs[s]);var l=i.appendChild(n("li")).appendChild(n("a"));l.href=o.url,l.appendChild(document.createTextNode(o.title));var c=new Image;c.src=o.favIconUrl?o.favIconUrl:fetchFavicon(o.url,t),l.insertAdjacentElement("afterbegin",c)}}a.appendChild(i)}document.addEventListener("DOMContentLoaded",function(e){console.time("main-load");var t,n=document.getElementById.bind(document);window.location.origin.startsWith("chrome-extension://")?t="2":window.location.origin.startsWith("moz-extension://")&&(t="unfiled_____"),void 0!==t&&(chrome.sessions.getRecentlyClosed(appendListToSidebar),chrome.topSites.get(appendListToSidebar),chrome.bookmarks.getSubTree(t,function(e){appendListToSidebar(e[0].children.find(e=>"m"==e.title).children,!1)}));var a=sessionStorage.getItem("staticLinks");a?function(e){var t=JSON.parse(e);appendToQuickLinks(t.quickLinks),linksArrayLen=t.slowLinks.length;for(let e=0;e<linksArrayLen;e++)appendListToSidebar(t.slowLinks[e],!1);var n=document.getElementById("feeds"),a=function(){this.removeEventListener("toggle",a);var e=new Date(localStorage.getItem("lastcheck"));for(obj in webfeeds=t.feeds.Web,webfeeds){var i=document.createElement("details");i.appendChild(document.createElement("summary")).appendChild(document.createTextNode(obj)),url=webfeeds[obj][0],loadFeeds(obj,webfeeds[obj],i,e),i.children[1].children&&n.appendChild(i)}localStorage.setItem("lastcheck",new Date)};n.addEventListener("toggle",a)}(a):readFile("links.json","application/json",e=>{responseText=e.responseText,sessionStorage.setItem("staticLinks",responseText),jsonFileHander(responseText)});var i=n("notepad");i.value=localStorage.getItem("notes");var r=function(){localStorage.setItem("notes",i.value)};n("btn-save-notes").addEventListener("click",r);var o=n("searchForm"),d=o.children[0];o.addEventListener("click",function(e){if(e.target.name){let n=e.target.name.split("&");for(var t=0;t<n.length-1;t++){let e=n[t].split("="),a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name",e[0]),a.setAttribute("value",e[1]),o.appendChild(a)}d.name=n[t]}else d.name="q";o.target=e.ctrlKey?"_blank":"_self"});var s=n("sidebar");document.addEventListener("mousemove",e=>{if(e.altKey)return;let t=s.style.display,n=s.offsetWidth,a=window.innerWidth,i=e.clientX;s.style.display=e.clientY>5&&(a-i<20||t&&a-n-i<0)?"flex":"none"}),i.addEventListener("keypress",e=>{e.ctrlKey&&"s"==e.key&&r()}),d.focus(),console.timeEnd("main-load")});